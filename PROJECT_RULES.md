# Правила проекта «Читалка с переводом»

## 1. Цель продукта
- Создать приложение-читалку со встроенным переводом текста.
- Начинать с малого и добавлять функции поэтапно.
- Каждый этап должен оставаться рабочим перед переходом к следующему.

## 2. Основной стек
- Фреймворк: Flutter (Dart).
- Библиотека перевода: пакет `translator`.
- Кандидаты для парсинга книг:
  - EPUB: `epubx` (первый кандидат).
  - FB2: пока без жёсткого выбора; сначала использовать парсинг на базе `xml`, обёртки-пакеты по необходимости.

## 2.1 Короткий список библиотек (проверено 2026-02-27)
- `translator`: интеграция перевода текста.
- `epubx`: кандидат для парсинга EPUB.
- `xml`: базовый парсер структуры FB2 (XML).
- `archive`: дополнительный помощник для сжатых FB2-файлов (`.fb2.zip`).

## 3. Принципы разработки
- Работать короткими итерациями: одна функция, один цикл проверки.
- Не добавлять несколько рискованных зависимостей в одном этапе.
- Держать доменную логику отдельно от UI.
- Сначала выбирать простую архитектуру, рефакторинг делать по мере роста проекта.

## 4. Структура проекта
- `lib/app.dart`: оболочка приложения и тема.
- `lib/features/reader/`: функциональность чтения.
- `lib/features/translation/`: функциональность перевода.
- `lib/core/`: общие модели, константы и утилиты.

## 5. План этапов
- Этап 1 (завершён):
  - Создать правила проекта.
  - Заменить шаблонное приложение на каркас читалки.
  - Подготовить структуру папок по фичам.
- Этап 2 (в работе):
  - Добавить выбор файла и постраничный просмотр текста книги.
  - Интегрировать сервис `translator` с простым потоком запроса.
- Этап 3:
  - Добавить поддержку EPUB и извлечение глав.
- Этап 4:
  - Добавить поддержку FB2.
- Этап 5:
  - Улучшить UX перевода: кэш, индикатор прогресса и состояния ошибок.

## 6. Правила качества
- Держать количество lint-предупреждений равным нулю в изменённых файлах.
- Использовать понятные имена классов и файлов.
- Избегать преждевременных абстракций.

## 7. Правила взаимодействия
- Если требование неясно, уточнять до реализации рискованного поведения.
- Фиксировать архитектурные решения в markdown-файлах.
- Записывать компромиссы при выборе библиотек для форматов файлов.

## 8. Язык проекта
- Пользовательский интерфейс должен быть полностью на русском языке.
- Документация проекта и описания задач должны быть на русском языке.
- Комментарии в изменяемых файлах писать на русском языке.
- Имена пакетов, библиотек, API и системных идентификаторов оставлять как есть.

## 9. Импорты и тесты
- Для внутренних модулей использовать только полные импорты `package:translate_reader/...`.
- Относительные импорты (`../`, `./`) не использовать.
- Тесты в проекте не вести и не добавлять.
